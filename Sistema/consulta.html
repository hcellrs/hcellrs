<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HCELL - Consulta de Preços</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body {
            /* Mantendo a identidade visual do Login */
            background-color: #1c3d5a; 
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .main-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Card de Busca */
        .search-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        /* Estilização da Tabela de Resultados */
        .results-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            min-height: 400px;
        }

        .table-hover tbody tr:hover {
            background-color: #f1f8ff;
            cursor: pointer;
        }

        .price-badge {
            background-color: #198754;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        /* Header simples */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="main-container">
        
        <div class="header-bar">
            <h3><i class="bi bi-gear-fill"></i> HCELL System</h3>
            <div>
                <span class="me-3"><i class="bi bi-person-circle"></i> Admin</span>
                <a href="index.html" class="btn btn-outline-light btn-sm">Sair</a>
            </div>
        </div>

        <div class="search-card">
            <h4 class="mb-3 text-primary"><i class="bi bi-search"></i> Consultar Peça</h4>
            <div class="row g-2">
                <div class="col-md-9">
                    <input type="text" id="searchInput" class="form-control form-control-lg" placeholder="Digite o modelo... (Ex: iPhone 11, A10, Note 8)" autocomplete="off">
                </div>
                <div class="col-md-3">
                    <button class="btn btn-primary w-100 btn-lg" onclick="filtrarDados()">Buscar</button>
                </div>
            </div>
        </div>

        <div class="results-card">
            <div id="loading" class="text-center p-5" style="display: none;">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="mt-2 text-muted">Carregando tabela atualizada...</p>
            </div>

            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Modelo</th>
                            <th>Peça / Serviço</th>
                            <th class="text-center">Valor</th>
                            <th>Detalhes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaResultados">
                        </tbody>
                </table>
            </div>
            
            <p id="noResults" class="text-center text-muted mt-5" style="display: none;">
                Nenhum resultado encontrado para essa busca.
            </p>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script>
        // Variável global para segurar seus dados
        let listaDePecas = [];

        document.addEventListener('DOMContentLoaded', () => {
            carregarSuaPlanilha();
        });

        const searchInput = document.getElementById('searchInput');
        
        // Busca automática ao digitar (opcional)
        searchInput.addEventListener('keyup', (e) => {
            filtrarDados(e.target.value);
        });

        // ---------------------------------------------------------
        // --- AQUI ENTRA A INTEGRAÇÃO COM SEU MÉTODO EXISTENTE ---
        // ---------------------------------------------------------
        
        function carregarSuaPlanilha() {
            // Mostra loading
            document.getElementById('loading').style.display = 'block';

            // *** SEU CÓDIGO ANTIGO VEM AQUI ***
            // Se você já tem um link JSON ou CSV, coloque aqui.
            // Exemplo genérico:
            
            const SEU_LINK = 'URL_DA_SUA_PLANILHA_OU_JSON';

            // Simulação (apague isso e coloque sua lógica real de fetch)
            // Se você usar o método do PapaParse que mencionei antes:
            /*
            Papa.parse(SEU_LINK, {
                download: true,
                header: true,
                complete: function(results) {
                    listaDePecas = results.data;
                    document.getElementById('loading').style.display = 'none';
                    filtrarDados(""); // Renderiza tudo inicial
                }
            });
            */

            // SIMULAÇÃO DE DADOS (Para você ver o visual funcionando agora)
            setTimeout(() => {
                listaDePecas = [
                    { modelo: "iPhone 11", peca: "Tela Original", valor: "R$ 450,00", obs: "Garantia 3 meses" },
                    { modelo: "iPhone 11", peca: "Bateria", valor: "R$ 250,00", obs: "Saúde 100%" },
                    { modelo: "Samsung A51", peca: "Conector Carga", valor: "R$ 120,00", obs: "Solda" },
                    { modelo: "Moto G8", peca: "Frontal", valor: "R$ 180,00", obs: "Incell" },
                ];
                document.getElementById('loading').style.display = 'none';
                filtrarDados(""); 
            }, 500);
        }

        // Função de Renderização
        function filtrarDados(termo = "") {
            const tbody = document.getElementById('tabelaResultados');
            const noResults = document.getElementById('noResults');
            const termoBusca = termo.toLowerCase() || document.getElementById('searchInput').value.toLowerCase();
            
            tbody.innerHTML = '';
            
            // Filtra
            const filtrados = listaDePecas.filter(item => {
                // Ajuste as chaves (item.modelo, item.peca) conforme sua planilha real
                const textoLinha = (item.modelo + " " + item.peca).toLowerCase();
                return textoLinha.includes(termoBusca);
            });

            // Renderiza
            if (filtrados.length > 0) {
                noResults.style.display = 'none';
                filtrados.forEach(item => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="fw-bold text-primary">${item.modelo || '-'}</td>
                        <td>${item.peca || '-'}</td>
                        <td class="text-center"><span class="price-badge">${item.valor || 'R$ 0,00'}</span></td>
                        <td><small class="text-muted">${item.obs || '-'}</small></td>
                    `;
                    tbody.appendChild(tr);
                });
            } else {
                noResults.style.display = 'block';
            }
        }
    </script>
</body>
</html>
