<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Tabela de Preços - HCELL</title>
	<link rel="icon" type="image/x-icon" href="images/favicon.png">
	<link rel="stylesheet" href="style.css">
	<script defer src="script.js"></script>

	<style>
		body {
			background: linear-gradient(135deg, #0e2433, #1b4a64);
			color: #fff;
			font-family: "Poppins", sans-serif;
			min-height: 100vh;
			margin: 0;
			padding-top: 70px;
		}

		header {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			height: 60px;
			background: rgba(0, 0, 0, 0.6);
			backdrop-filter: blur(6px);
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 0 20px;
			z-index: 1000;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
		}

		header a.voltar {
			background: var(--primary-color, #1a73e8);
			color: #fff;
			padding: 10px 16px;
			border-radius: 8px;
			text-decoration: none;
			font-weight: bold;
			transition: 0.2s;
		}

		header a.voltar:hover {
			background: #155fc4;
			transform: scale(1.05);
		}

		header h1 {
			margin: 0;
			font-size: 20px;
			color: #fff;
		}

		.container {
			max-width: 800px;
			margin: 40px auto;
			padding: 30px;
			background: rgba(255, 255, 255, 0.08);
			border-radius: 16px;
			box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
		}

		.btn-container {
			text-align: center;
			margin-bottom: 25px;
		}

		.btn-fornecedor {
			padding: 10px 18px;
			margin: 5px;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 15px;
			color: #fff;
			font-weight: bold;
			transition: transform 0.2s, opacity 0.2s;
		}

		.btn-fornecedor:hover {
			transform: scale(1.05);
			opacity: 0.9;
		}

		.btn-lidercell { background-color: #ffcc00; color: #000; }
		.btn-goldcell { background-color: #d4af37; color: #000; }
		.btn-eletrocell { background-color: #007bff; }
		.btn-novapecas { background-color: #28a745; }

		.btn-ativo {
			outline: 3px solid var(--secondary-color, #1a73e8);
			box-shadow: 0 0 8px rgba(26,115,232,0.6);
			transform: scale(1.07);
		}

		#fornecedorAtual {
			text-align: center;
			font-weight: bold;
			font-size: 16px;
			color: var(--primary-color, #1a73e8);
			margin-top: 10px;
			margin-bottom: 15px;
		}

		#searchInput {
			width: 100%;
			max-width: 500px;
			display: block;
			margin: 0 auto 20px auto;
			padding: 12px 15px;
			border-radius: var(--border-radius, 8px);
			border: none;
			font-size: 16px;
			outline: none;
			box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
		}

		.produto-item {
			padding: 10px 15px;
			margin: 5px 0;
			background: rgba(255, 255, 255, 0.1);
			border-radius: 10px;
			backdrop-filter: blur(2px);
			display: flex;
			justify-content: space-between;
			align-items: center;
			transition: 0.2s;
		}

		.produto-item:hover {
			background: rgba(255, 255, 255, 0.18);
			transform: scale(1.02);
		}

		.produto-item strong {
			color: #00ff9d;
		}

		.sem-resultados {
			text-align: center;
			font-style: italic;
			color: #ccc;
		}
	</style>
</head>
<body>

	<header>
		<h1>Tabela de Preços</h1>
		<a href="index.html" class="voltar">⬅ Voltar</a>
	</header>

	<div class="container">
		<div class="btn-container">
			<button class="btn-fornecedor btn-lidercell" onclick="selecionarFornecedor('lidercell', this)">Lidercell</button>
			<button class="btn-fornecedor btn-goldcell" onclick="selecionarFornecedor('goldcell', this)">Goldcell</button>
			<button class="btn-fornecedor btn-eletrocell" onclick="selecionarFornecedor('eletrocell', this)">Eletrocell</button>
			<button class="btn-fornecedor btn-novapecas" onclick="selecionarFornecedor('novapecas', this)">Nova Peças</button>
		</div>

		<div id="fornecedorAtual">Selecione um fornecedor para iniciar a consulta.</div>

		<input type="text" id="searchInput" placeholder="Digite o modelo do produto...">

		<div id="resultados">
			<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>
		</div>
	</div>

	<script>
		const planilhas = {
			lidercell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTZn563fJoYnFQa2569Tj4aFmBdxmxmKQF3wUlPKEOeY1tQTOoHj18cMflnPx2ea4Q2cQeW13QShzHh/pub?gid=0&single=true&output=csv",
			goldcell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0GfwlmUazjTIO8LDmn9XMnThhgbKdlqwFgHHvO4oCzUNPlebYbRjZRhv2iCRujK37P4KklsitoS--/pub?gid=0&single=true&output=csv",
			eletrocell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVODR_ZxfbJPiwXyXvTQLFboPiDvwy_32oUnLApVSxqNP_TIO4_tAELsBHELnQL4RXZlBOxkjp8Z-j/pub?gid=0&single=true&output=csv",
			novapecas: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRCX7SYJFFUdD8QI3zPaq4QqSkzapv5y2R7KrXmqkYle-NqL_6n8bh9WatrzvhR_-aNW9jsj-Df2G-/pub?gid=0&single=true&output=csv"
		};

		let produtos = [];
		const resultadosDiv = document.getElementById('resultados');
		const fornecedorAtual = document.getElementById('fornecedorAtual');
		const searchInput = document.getElementById('searchInput');

		function parseCSVLine(line) {
			const fields = [];
			let cur = '', inQuotes = false;
			for (let ch of line) {
				if (ch === '"') inQuotes = !inQuotes;
				else if (ch === ',' && !inQuotes) { fields.push(cur); cur = ''; }
				else cur += ch;
			}
			fields.push(cur);
			return fields;
		}

		function parsePrice(raw) {
			if (!raw) return NaN;
			let s = raw.replace(/[^\d,.-]/g, '').replace(',', '.');
			return parseFloat(s);
		}

		function formatBRL(n) {
			return isNaN(n) ? '' : n.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
		}

		async function carregarProdutos(url) {
			try {
				const resp = await fetch(url);
				const csv = await resp.text();
				const linhas = csv.split(/\r?\n/).filter(l => l.trim());
				produtos = linhas.slice(1).map(l => {
					const [modelo, preco] = parseCSVLine(l);
					return { modelo, preco_venda: formatBRL(parsePrice(preco)) };
				});
				resultadosDiv.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>';
			} catch {
				resultadosDiv.innerHTML = '<p class="sem-resultados">Erro ao carregar planilha.</p>';
			}
		}

		function selecionarFornecedor(nome, botao) {
			document.querySelectorAll('.btn-fornecedor').forEach(b => b.classList.remove('btn-ativo'));
			botao.classList.add('btn-ativo');
			fornecedorAtual.textContent = "Consulta atual: " + botao.innerText;
			carregarProdutos(planilhas[nome]);
			searchInput.value = '';
		}

		searchInput.addEventListener('input', e => {
			const termo = e.target.value.toLowerCase();
			const filtrados = produtos.filter(p => p.modelo.toLowerCase().includes(termo));
			resultadosDiv.innerHTML = filtrados.length ?
				filtrados.map(p => `<div class="produto-item"><span>${p.modelo}</span><strong>${p.preco_venda}</strong></div>`).join('') :
				'<p class="sem-resultados">Nenhum produto encontrado.</p>';
		});
	</script>

</body>
</html>
