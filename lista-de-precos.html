tro<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Tabela de Pre√ßos - HCELL</title>
	<link rel="icon" type="image/x-icon" href="images/favicon.png">
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f0f2f5;
			padding: 20px;
			color: #333;
		}
		.container {
			max-width: 600px;
			margin: 0 auto;
			background-color: #ffffff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}
		h1 {
			text-align: center;
			color: #1a73e8;
			margin-bottom: 20px;
		}
		#searchInput {
			width: 100%;
			padding: 12px;
			border: 1px solid #ddd;
			border-radius: 4px;
			font-size: 16px;
			box-sizing: border-box;
			margin-bottom: 20px;
		}
		#resultados {
			list-style: none;
			padding: 0;
			margin: 0;
		}
		.produto-item {
			padding: 15px;
			border-bottom: 1px solid #eee;
			transition: background-color 0.2s ease;
		}
		.produto-item:last-child {
			border-bottom: none;
		}
		.produto-item:hover {
			background-color: #f9f9f9;
		}
		.produto-modelo {
			font-weight: bold;
			font-size: 18px;
			color: #333;
			margin-bottom: 5px;
		}
		.produto-valor {
			font-size: 16px;
			color: #555;
			margin: 5px 0;
		}
		.sem-resultados {
			text-align: center;
			color: #888;
			font-style: italic;
			padding: 20px;
		}
		.btn-container {
			text-align: center;
			margin-bottom: 25px;
		}
		.btn {
			padding: 10px 18px;
			margin: 5px;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 15px;
			color: #fff;
			transition: transform 0.2s, opacity 0.2s;
		}
		.btn:hover {
			transform: scale(1.05);
			opacity: 0.9;
		}
		/* Cores dos bot√µes ‚Äî voc√™ pode alterar */
		.btn-lidercell { background-color: #ffcc00; color: #000; } /* Amarelo */
		.btn-goldcell { background-color: #d4af37; color: #000; } /* Dourado */
		.btn-eletrocell { background-color: #007bff; } /* Azul */
		.btn-novapecas { background-color: #28a745; } /* Verde */
		
		.voltar {
			display: inline-block;
			margin-bottom: 20px;
			text-decoration: none;
			color: #fff;
			background-color: #1a73e8;
			padding: 10px 15px;
			border-radius: 6px;
		}
		.voltar:hover {
			background-color: #155bc5;
		}
	</style>
</head>
<body>
	<a href="index.html" class="voltar">Voltar para o In√≠cio</a>
	
	<h1>Tabela de Pre√ßos</h1>

	<div class="btn-container">
		<!-- üîπ Altere o nome do bot√£o e o link no c√≥digo JS abaixo -->
		<button class="btn btn-lidercell" onclick="selecionarFornecedor('lidercell')">Lidercell</button>
		<button class="btn btn-goldcell" onclick="selecionarFornecedor('goldcell')">Goldcell</button>
		<button class="btn btn-eletrocell" onclick="selecionarFornecedor('eletrocell')">Eletrocell</button>
		<button class="btn btn-novapecas" onclick="selecionarFornecedor('novapecas')">Nova Pe√ßas</button>
	</div>

	<div class="container">
		<h1>Consulta de Pre√ßos</h1>
		<input type="text" id="searchInput" placeholder="Digite o modelo do produto...">
		<div id="resultados">
			<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>
		</div>
	</div>

	<script>
		const planilhas = {
			// üîπ Cole os links CSV de cada fornecedor abaixo:
			lidercell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTZn563fJoYnFQa2569Tj4aFmBdxmxmKQF3wUlPKEOeY1tQTOoHj18cMflnPx2ea4Q2cQeW13QShzHh/pub?gid=0&single=true&output=csv",
			goldcell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0GfwlmUazjTIO8LDmn9XMnThhgbKdlqwFgHHvO4oCzUNPlebYbRjZRhv2iCRujK37P4KklsitoS--/pub?gid=0&single=true&output=csv",
			eletrocell: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVODR_ZxfbJPiwXyXvTQLFboPiDvwy_32oUnLApVSxqNP_TIO4_tAELsBHELnQL4RXZlBOxkjp8Z-j/pub?gid=0&single=true&output=csv",
			novapecas: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQRCX7SYJFFUdD8QI3zPaq4QqSkzapv5y2R7KrXmqkYle-NqL_6n8bh9WatrzvhR_-aNW9jsj-Df2G-/pub?gid=0&single=true&output=csv"
		};

		let produtos = [];

		const searchInput = document.getElementById('searchInput');
		const resultadosDiv = document.getElementById('resultados');

		function parseCSVLine(line) {
			const fields = [];
			let cur = '';
			let inQuotes = false;
			for (let i = 0; i < line.length; i++) {
				const ch = line[i];
				if (ch === '"') {
					if (inQuotes && line[i+1] === '"') { cur += '"'; i++; }
					else { inQuotes = !inQuotes; }
				} else if (ch === ',' && !inQuotes) {
					fields.push(cur);
					cur = '';
				} else {
					cur += ch;
				}
			}
			fields.push(cur);
			return fields;
		}

		function parsePriceNumber(raw) {
			if (!raw) return NaN;
			let s = String(raw).trim();
			s = s.replace(/\u00A0/g,''); 
			s = s.replace(/[^\d\.,-]/g, '');
			if (!s) return NaN;
			if (s.indexOf('.') !== -1 && s.indexOf(',') !== -1) {
				s = s.replace(/\./g, '').replace(',', '.');
			} else {
				s = s.replace(',', '.');
			}
			const n = parseFloat(s);
			return isFinite(n) ? n : NaN;
		}

		function formatBRL(value) {
			if (isNaN(value)) return '';
			return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
		}

		function displayResults(results) {
			resultadosDiv.innerHTML = '';
			if (results.length > 0) {
				results.forEach(produto => {
					const produtoItem = document.createElement('div');
					produtoItem.className = 'produto-item';
					produtoItem.innerHTML = `
						<div class="produto-modelo">${produto.modelo}</div>
						<div class="produto-valor">${produto.preco_venda}</div>
					`;
					resultadosDiv.appendChild(produtoItem);
				});
			} else {
				resultadosDiv.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado com este termo.</p>';
			}
		}

		async function carregarProdutos(url) {
			try {
				const resp = await fetch(url);
				if (!resp.ok) throw new Error('Erro ao buscar CSV: ' + resp.status);
				const csv = await resp.text();
				const linhas = csv.split(/\r?\n/).filter(l => l.trim() !== '');
				if (linhas.length === 0) {
					resultadosDiv.innerHTML = '<p class="sem-resultados">Planilha vazia.</p>';
					return;
				}

				let startIndex = 0;
				const firstCols = parseCSVLine(linhas[0]).map(c => (c||'').toString().toLowerCase());
				if (firstCols.some(c => /produto|modelo|preco|valor/.test(c))) {
					startIndex = 1;
				}

				const parsed = [];
				for (let i = startIndex; i < linhas.length; i++) {
					const cols = parseCSVLine(linhas[i]);
					const c0 = (cols[0] || '').trim().replace(/^"(.*)"$/,'$1');
					const c1 = (cols[1] || '').trim().replace(/^"(.*)"$/,'$1');

					if (!c0 && !c1) continue;

					const num = parsePriceNumber(c1);
					const precoVenda = isNaN(num) ? (c1 || '') : formatBRL(num);

					parsed.push({ modelo: c0, preco_venda: precoVenda });
				}

				produtos = parsed;
				resultadosDiv.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>';

			} catch (err) {
				console.error('Erro ao carregar planilha:', err);
				resultadosDiv.innerHTML = '<p class="sem-resultados">Erro ao carregar planilha.</p>';
			}
		}

		function selecionarFornecedor(nome) {
			const url = planilhas[nome];
			if (!url) {
				alert("Link da planilha n√£o configurado para " + nome);
				return;
			}
			carregarProdutos(url);
			searchInput.value = '';
			resultadosDiv.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>';
		}

		searchInput.addEventListener('input', (e) => {
			const searchTerm = e.target.value.toLowerCase();
			if (searchTerm.length > 0) {
				const filtered = produtos.filter(produto => produto.modelo.toLowerCase().includes(searchTerm));
				displayResults(filtered);
			} else {
				resultadosDiv.innerHTML = '<p class="sem-resultados">Nenhum produto encontrado. Digite para buscar.</p>';
			}
		});
	</script>
</body>
</html>







